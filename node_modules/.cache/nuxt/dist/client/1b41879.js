(window.webpackJsonp=window.webpackJsonp||[]).push([[17,14,16],{402:function(t,e,n){"use strict";e.a={BaseURL:"https://api.qa.channel.buk0.com/zm5/"}},560:function(t,e,n){"use strict";n.r(e);var o=n(52),r=(n(112),n(402)),l={props:["data","id"],data:function(){return{dataContent:{},appId:"PLATFORM001",title:"",content:""}},mounted:function(){this.id&&this.getContentbyId()},methods:{getContentbyId:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.contentId=t.id,e.next=3,t.$axios.$get(r.a.BaseURL+"v1/contents?appId="+t.appId+"&contentId="+t.contentId).then((function(e){t.title=e.items[0].title,t.content=e.items[0].content}));case 3:case"end":return e.stop()}}),e)})))()}}},c=n(67),component=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"preview-modal"},[e("div",{staticClass:"modal-wrapper"},[e("div",{staticClass:"modal-container"},[e("div",{staticClass:"header"},[e("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("b-icon",{attrs:{icon:"x"}})],1)]),t._v(" "),e("div",{staticClass:"modal-body d-block"},[e("h2",[t._v(t._s(t.title))]),t._v(" "),e("div",{domProps:{innerHTML:t._s(t.content)}})])])])])}),[],!1,null,null,null);e.default=component.exports},566:function(t,e,n){var content=n(580);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(82).default)("9d159adc",content,!0,{sourceMap:!1})},572:function(t,e,n){"use strict";n.r(e);var o=n(52),r=(n(112),n(40),n(402)),l={props:["files"],data:function(){return{imgUrl:""}},mounted:function(){},methods:{selectFile:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var img,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:img=t.target.files[0],(data=new FormData).append("appId","PLATFORM001"),data.append("image",img,data.name),e.$axios.$post(r.a.BaseURL+"v1/files/upload",data).then((function(t){e.imgUrl=t.url,e.$emit("bannerUrl",e.imgUrl),e.$emit("close")})).catch((function(t){alert(t)}));case 5:case"end":return n.stop()}}),n)})))()}}},c=n(67),component=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"crm-modal"},[e("div",{staticClass:"modal-wrapper"},[e("div",{staticClass:"modal-container"},[e("div",{staticClass:"header"},[e("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("b-icon",{attrs:{icon:"x"}})],1)]),t._v(" "),e("div",{staticClass:"modal-body d-block"},[e("input",{attrs:{type:"file",accept:".jpeg,.jpg,.png,image/jpeg,image/png","aria-label":"upload image button"},on:{change:t.selectFile}})])])])])}),[],!1,null,null,null);e.default=component.exports},573:function(t,e,n){"use strict";n.r(e);var o={components:{Input:n(404).default},data:function(){return{bannerLink:""}},methods:{submit:function(){console.log(this.bannerLink),this.$emit("link",this.bannerLink),this.$emit("close")}}},r=n(67),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"crm-modal"},[e("div",{staticClass:"modal-wrapper"},[e("div",{staticClass:"modal-container"},[e("div",{staticClass:"header"},[e("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("b-icon",{attrs:{icon:"x"}})],1)]),t._v(" "),e("div",{staticClass:"modal-body"},[e("h6",[t._v("Add Banner Link")]),t._v(" "),e("div",{staticClass:"d-flex"},[e("Input",{attrs:{placeholder:"Link ....",required:!1},model:{value:t.bannerLink,callback:function(e){t.bannerLink=e},expression:"bannerLink"}}),t._v(" "),e("b-button",{on:{click:function(e){return t.submit()}}},[t._v("ADD")])],1)])])])])}),[],!1,null,null,null);e.default=component.exports},574:function(t,e,n){"use strict";n.r(e);var o={components:{Input:n(404).default},data:function(){return{bannerLink:""}},methods:{backToHome:function(){this.$router.push("/home"),this.$emit("close")}}},r=n(67),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"crm-modal"},[e("div",{staticClass:"modal-wrapper"},[e("div",{staticClass:"modal-container"},[e("div",{staticClass:"header"}),t._v(" "),t._m(0),t._v(" "),e("b-button",{on:{click:function(e){return t.backToHome()}}},[t._v("กลับสู่หน้าหลัก")])],1)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"modal-body"},[t("h6",[this._v("บันทึกสำเร็จ")])])}],!1,null,null,null);e.default=component.exports},579:function(t,e,n){"use strict";n(566)},580:function(t,e,n){var o=n(81)(!1);o.push([t.i,".add-content-page{padding:20px 48px}.add-content-page .banner-section .banner-show{width:auto;height:auto;margin:auto}.add-content-page #percent-box{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999999999999;display:none;background-color:#e4eef9;padding:1rem}.add-content-page .show{display:block!important}.add-content-page .hide{display:none!important}.add-content-page .publish-section{display:flex}.add-content-page .publish-section .switch-publish{align-self:center!important}.add-content-page .form-group-btn{margin-bottom:1rem;text-align:right}",""]),t.exports=o},592:function(t,e,n){"use strict";n.r(e);var o=n(52),r=(n(112),n(40),n(196),n(22)),l=n(564),c=n(404),d=n(572),m=n(573),f=n(560),v=n(576),h=n(554),k=n(565),y=n(555),x=n(556),w=n(557),_=n(574),C=n(135),D=n.n(C),L=n(402),M=n(249),$=n(190),I=n(401),B=r.default.extend({mixins:[M.validationMixin],layout:"default",name:"LoginPage",components:{RadioButton:l.default,InputField:c.default,UploadBanner:d.default,AddLinkModal:m.default,Editor:v.a,Datepicker:h.default,SwitchesField:k.default,Table:y.default,Button:x.default,SelectField:w.default,PreviewContent:f.default,SuccessModal:_.default},data:function(){return{languageSelected:"",languageList:[{item:"TH",name:"TH"},{item:"EN",name:"EN"}],showUploadModal:!1,showAddlinkModal:!1,showPreviewModal:!1,showSuccessModal:!1,textSuccessShow:"",bannerLink:"",bannerUrl:"",tinyKey:"sqr6zktjeya5l2ne1oij0b0qmmhnbmuv7exu07t83p51a8k1",content:"",files:[],tinyMce:{height:500,menubar:"",plugins:["advlist autolink lists link image charmap","searchreplace visualblocks code fullscreen","print preview anchor insertdatetime media","paste code help wordcount table code"],toolbar1:"bold italic underline strikethrough fontsizeselect formatselect forecolor backcolor link image media table                     alignleft aligncenter alignright bullist numlist outdent indent undo redo code",image_title:!0,automatic_uploads:!0,file_picker_types:"image",file_picker_callback:function(t,e,meta){var input=document.createElement("input");input.setAttribute("type","file"),input.setAttribute("accept","image/*"),input.addEventListener("change",(function(e){var n=e.target.files[0],data=new FormData;data.append("appId","PLATFORM001"),data.append("image",n,n.name);var o=new FileReader;D.a.post(L.a.BaseURL+"v1/files/upload",data,{onUploadProgress:function(t){var e;e=Math.round(100*t.loaded/t.total),document.getElementById("percent-box").innerHTML="Uploading "+e+" %",document.getElementById("percent-box").classList.add("show")}}).then((function(e){200==e.status?(document.getElementById("percent-box").classList.add("hide"),t(e.data.url,{title:n.name})):(document.getElementById("percent-box").classList.add("hide"),alert("Failed to upload: ".concat(e.statusText)))})).catch((function(t){alert(t),document.getElementById("percent-box").classList.add("hide")})),o.readAsDataURL(n)})),input.click()}},startDate:"",endDate:"",published:!1,alias:"",optionsCategory:[{value:"Content",text:"Content"},{value:"Campaign",text:"Campaign"},{value:"Promotion",text:"Promotion"},{value:"News",text:"News"},{value:"Announcement",text:"Announcement"},{value:"Ads",text:"Ads"}],selectedCategory:"",contentJsons:[{key:"",value:""}],dataJsons:{},title:"",fileLists:[],appId:"PLATFORM001",contentId:"",dataDetails:[],dataPreview:{},mode:"",form:{startDate:null}}},validations:{form:{startDate:{required:$.required}}},mounted:function(){var t=this.$route.query.contentId,e=this.$route.query.mode;t&&this.getContentDetails(t,e)},methods:{validateState:function(t){var e=this.$v.form[t],n=e.$dirty,o=e.$error;return console.log(n,o),n?!o:null},getBannerLink:function(t){this.bannerLink=t},getBannerUrl:function(t){this.bannerUrl=t,console.log(this.bannerUrl)},getFileList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get(L.a.BaseURL+"v1/files?appId="+t.appId+"&itemsPerPage=1");case 2:t.fileLists=e.sent,console.log(t.fileLists);case 4:case"end":return e.stop()}}),e)})))()},onSubmitAdd:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,i,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("startDate",t.$v.form,t.form.startDate),t.$v.form.$touch(),!t.$v.form.$anyError){e.next=5;break}return alert("กรุณากรอกข้อมูลให้ครบ"),e.abrupt("return");case 5:for(n={},i=0;i<t.contentJsons.length;i++)n[t.contentJsons[i].key]=t.contentJsons[i].value;if(t.dataJsons=t.contentJsons.length>0&&""!==t.contentJsons[0].key?JSON.parse(JSON.stringify(n)):{},data={},data=t.contentId&&"duplicate"!==t.mode?{appId:"PLATFORM001",content:t.content,contentJson:t.dataJsons,publishDate:t.form.startDate?I(t.form.startDate).format("YYYY-MM-DD[T]HH:mm:ss"):"",expiredDate:t.endDate?I(t.endDate).format("YYYY-MM-DD[T]HH:mm:ss"):"",status:t.published?"ENABLED":"DISABLED",alias:t.alias,title:t.title,orderBy:"1",category:t.selectedCategory,updateBy:"70007696"}:{appId:"PLATFORM001",content:t.content,contentJson:t.dataJsons,publishDate:t.form.startDate?I(t.form.startDate).format("YYYY-MM-DDTHH:MM:SS"):"",expiredDate:t.endDate?I(t.endDate).format("YYYY-MM-DDTHH:MM:SS"):"",status:t.published?"ENABLED":"DISABLED",alias:t.alias,title:t.title,orderBy:"1",category:t.selectedCategory,createBy:"70007696"},console.log("data======",data),!t.contentId||"duplicate"===t.mode){e.next=16;break}return e.next=14,t.$axios.$patch(L.a.BaseURL+"v1/contents/"+t.contentId,data).then((function(e){t.showSuccessModal=!0})).catch((function(t){alert(t)}));case 14:e.next=18;break;case 16:return e.next=18,t.$axios.$post(L.a.BaseURL+"/v1/contents/create",data).then((function(e){e.contentId&&(t.showSuccessModal=!0)})).catch((function(t){alert(t)}));case 18:case"end":return e.stop()}}),e)})))()},addContentJson:function(){this.contentJsons.push({key:"",value:""})},DeleteContentJson:function(t,e){console.log("item",t,e);var n=this.contentJsons.indexOf(t);n>-1&&this.contentJsons.splice(n,1)},getContentDetails:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n.contentId=t,n.mode=e,o.next=4,n.$axios.$get(L.a.BaseURL+"v1/contents?appId="+n.appId+"&contentId="+t).then((function(t){n.languageSelected=t.items[0].languageSelected,n.bannerLink=t.items[0].bannerLink,n.bannerUrl=t.items[0].bannerUrl,n.title=t.items[0].title,n.selectedCategory=t.items[0].category,n.content=t.items[0].content,n.form.startDate=new Date(t.items[0].publishDate),n.endDate=new Date(t.items[0].expiredDate),n.published="DISABLED"!==t.items[0].status,n.alias=t.items[0].alias;var e=[];for(var i in t.items[0].contentJson)e.push({key:i,value:t.items[0].contentJson[i]});console.log("dataJsons",e,n.contentJsons),n.contentJsons=e}));case 4:case"end":return o.stop()}}),o)})))()},previewContent:function(){this.contentId?this.showPreviewModal=!0:(this.dataPreview={title:this.title,content:this.content},this.dataPreview!={}&&(this.showPreviewModal=!0))}}}),S=(n(579),n(67)),component=Object(S.a)(B,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"add-content-page"},[e("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.onSubmitAdd.apply(null,arguments)}}},[e("b-tabs",{attrs:{"content-class":"my-3"}},[e("b-tab",{attrs:{title:"Content Setting"}},[e("div",{staticClass:"category-section d-flex"},[e("SelectField",{attrs:{title:"Category",options:t.optionsCategory},model:{value:t.selectedCategory,callback:function(e){t.selectedCategory=e},expression:"selectedCategory"}})],1),t._v(" "),e("hr"),t._v(" "),e("InputField",{attrs:{title:"Title",placeholder:"Title"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),e("hr"),t._v(" "),e("InputField",{attrs:{title:"Alias",placeholder:"Alias"},model:{value:t.alias,callback:function(e){t.alias=e},expression:"alias"}}),t._v(" "),e("hr"),t._v(" "),e("h6",{staticClass:"mr-3"},[t._v("Body")]),t._v(" "),e("p",{attrs:{id:"percent-box"}},[t._v("Uploading 0 %")]),t._v(" "),e("Editor",{attrs:{init:t.tinyMce,apiKey:t.tinyKey},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),e("div",{staticClass:"text-right my-3"},[e("Button",{attrs:{label:"Preview",variant:"primary"},on:{click:function(e){return t.previewContent()}}})],1)],1),t._v(" "),e("b-tab",{attrs:{title:"Content Json"}},[t._l(t.contentJsons,(function(n,o){return e("div",{key:o,staticClass:"form-row"},[e("div",{staticClass:"form-group col-md-5"},[e("label",[t._v("Key")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:n.key,expression:"item.key"}],staticClass:"form-control",attrs:{name:n.key,type:"text",placeholder:"key"},domProps:{value:n.key},on:{input:function(e){e.target.composing||t.$set(n,"key",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group col-md-5"},[e("label",[t._v("Value")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:n.value,expression:"item.value"}],staticClass:"form-control",attrs:{name:n.value,type:"text",placeholder:"value"},domProps:{value:n.value},on:{input:function(e){e.target.composing||t.$set(n,"value",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group col-md-2",staticStyle:{"margin-top":"30px"}},[0!=o?e("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return t.DeleteContentJson(n,o)}}},[t._v("\n                -\n              ")]):t._e()])])})),t._v(" "),e("div",{staticClass:"form-group-btn"},[e("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:t.addContentJson}},[t._v("\n              +\n            ")])])],2),t._v(" "),e("b-tab",{attrs:{title:"Publish Setting"}},[e("div",{staticClass:"text-right"},[e("Button",{staticStyle:{width:"20%"},attrs:{type:"submit",label:"บันทึก",variant:"success"}})],1),t._v(" "),e("b-container",[e("b-row",[e("b-col",[e("Datepicker",{staticClass:"mr-3",attrs:{title:"วันที่เริ่มต้น",required:!0,state:t.validateState("startDate"),disabledDateBefore:new Date},model:{value:t.$v.form.startDate.$model,callback:function(e){t.$set(t.$v.form.startDate,"$model",e)},expression:"$v.form.startDate.$model"}})],1),t._v(" "),e("b-col",[e("Datepicker",{staticClass:"mr-3",attrs:{title:"วันที่สิ้นสุด",disabledDateBefore:t.$v.form.startDate.$model},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),t._v(" "),e("b-col",{attrs:{"align-self":"center"}},[e("SwitchesField",{staticClass:"m-auto",attrs:{title:"Active"},model:{value:t.published,callback:function(e){t.published=e},expression:"published"}})],1)],1)],1),t._v(" "),e("hr")],1)],1)],1),t._v(" "),t.showUploadModal?e("UploadBanner",{attrs:{files:t.fileLists},on:{close:function(e){t.showUploadModal=!1},bannerUrl:t.getBannerUrl}}):t._e(),t._v(" "),t.showAddlinkModal?e("AddLinkModal",{on:{close:function(e){t.showAddlinkModal=!1},link:t.getBannerLink}}):t._e(),t._v(" "),t.showPreviewModal?e("PreviewContent",{attrs:{data:t.dataPreview,id:t.contentId},on:{close:function(e){t.showPreviewModal=!1}}}):t._e(),t._v(" "),t.showSuccessModal?e("SuccessModal",{attrs:{text:t.textSuccessShow},on:{close:function(e){t.showSuccessModal=!1}}}):t._e()],1)}),[],!1,null,null,null);e.default=component.exports}}]);